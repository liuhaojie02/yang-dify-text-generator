# 项目环境版本要求

## 概述
这是一个基于 Next.js 14 的 React 聊天应用项目，使用 TypeScript 开发。

## 核心环境要求

### Node.js
- **最低版本**: 18.17.0
- **推荐版本**: 20.19.0
- **说明**: Next.js 14.2.32 要求 Node.js >= 18.17.0

### npm
- **版本**: 10.8.2 (随 Node.js 20.19.0 一起安装)
- **镜像源**: 项目使用官方 npm 源 (https://registry.npmjs.org/)

## 主要框架和库版本

### 核心框架
| 包名 | 版本 | 说明 |
|------|------|------|
| Next.js | ^14.2.32 | React 全栈框架 |
| React | ~18.3.0 | UI 库 |
| React DOM | ~18.3.0 | React DOM 渲染器 |
| TypeScript | 4.9.5 | 类型系统 |

### 样式和 UI
| 包名 | 版本 | 说明 |
|------|------|------|
| Tailwind CSS | ^3.4.14 | CSS 框架 |
| @tailwindcss/typography | ^0.5.9 | 排版插件 |
| PostCSS | ^8.4.47 | CSS 处理器 |
| Autoprefixer | ^10.4.20 | CSS 自动前缀 |
| Sass | ^1.61.0 | CSS 预处理器 |

### 状态管理和数据获取
| 包名 | 版本 | 说明 |
|------|------|------|
| Zustand | ^4.5.2 | 状态管理 |
| SWR | ^2.3.0 | 数据获取 |
| ahooks | ^3.8.4 | React Hooks 库 |

### 国际化
| 包名 | 版本 | 说明 |
|------|------|------|
| i18next | ^23.16.4 | 国际化框架 |
| react-i18next | ^12.2.0 | React 国际化 |
| @formatjs/intl-localematcher | ^0.5.6 | 语言匹配 |

### 代码质量和格式化
| 包名 | 版本 | 说明 |
|------|------|------|
| ESLint | ^9.10.0 | 代码检查 |
| @antfu/eslint-config | ~5.1.0 | ESLint 配置 |
| eslint-config-next | ^15.5.2 | Next.js ESLint 配置 |
| lint-staged | ^15.2.10 | Git 提交前检查 |
| Husky | ^9.1.7 | Git hooks |

### 其他重要依赖
| 包名 | 版本 | 说明 |
|------|------|------|
| dify-client | ^2.3.1 | Dify AI 客户端 |
| @monaco-editor/react | ^4.6.0 | 代码编辑器 |
| react-markdown | ^8.0.6 | Markdown 渲染 |
| katex | ^0.16.21 | 数学公式渲染 |
| axios | ^1.3.5 | HTTP 客户端 |

## 开发工具配置

### TypeScript 配置
- **目标版本**: ES2015
- **模块系统**: ESNext
- **严格模式**: 启用
- **JSX**: preserve (由 Next.js 处理)

### ESLint 配置
- **主配置**: @antfu/eslint-config
- **Next.js 集成**: eslint-config-next
- **支持文件类型**: .js, .jsx, .ts, .tsx

### 项目结构
```
app/                    # Next.js App Router
├── api/               # API 路由
├── components/        # React 组件
├── styles/           # 全局样式
└── layout.tsx        # 根布局

components/            # 共享组件
├── base/             # 基础组件
├── chat/             # 聊天相关组件
└── workflow/         # 工作流组件

i18n/                 # 国际化配置
├── lang/             # 语言文件
└── client.ts         # 客户端配置

service/              # API 服务层
├── base.ts           # 基础 HTTP 客户端
└── index.ts          # API 方法

types/                # TypeScript 类型定义
```

## 环境变量
项目支持以下环境变量（需要创建 `.env.local` 文件）：
- 根据项目需要配置相关环境变量
环境变量如下：
# APP ID
NEXT_PUBLIC_APP_ID=HFqFaQ75it2dFJyT
# APP API key
NEXT_PUBLIC_APP_KEY=app-TINnuJFEG5s6hNtMrzOjNFMj
# API url prefix
NEXT_PUBLIC_API_URL=
# APP type
# true for workflow apps
NEXT_PUBLIC_APP_TYPE_WORKFLOW=workflow


## 安装和运行

### 1. 安装依赖
```bash
# 确保使用项目级别的 npm 源配置
npm install
```

### 2. 开发模式
```bash
npm run dev
```
访问 http://localhost:3000

### 3. 生产构建
```bash
npm run build
npm start
```

### 4. 代码检查
```bash
npm run lint
npm run fix
```

## 注意事项

1. **npm 源配置**: 项目使用 `.npmrc` 文件配置为官方 npm 源，不影响全局配置
2. **Node.js 版本**: 必须使用 Node.js 18.17.0 或更高版本
3. **TypeScript**: 项目使用较旧的 TypeScript 4.9.5，建议后续升级
4. **ESLint**: 已升级到 ESLint 9.x 以兼容最新的配置包
5. **Next.js**: 使用 App Router 架构，注意路由结构

## 故障排除

### 常见问题
1. **SWC 下载失败**: 确保使用官方 npm 源
2. **Node.js 版本不兼容**: 升级到 Node.js 20.19.0
3. **依赖冲突**: 删除 node_modules 和 package-lock.json 后重新安装

### 版本兼容性
- Next.js 14.2.32 与 React 18.3.0 完全兼容
- ESLint 9.x 与 @antfu/eslint-config 5.1.0 兼容
- TypeScript 4.9.5 与 Next.js 14.2.32 兼容